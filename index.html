<!DOCTYPE html>
<html>
<title>W3.CSS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3mobile.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-teal.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>

<head>
     <LINK REL="SHORTCUT ICON" HREF="http://www.mydomain.com/myicon.ico">
</head>
<body style="max-width:600px">

    <header class="w3-bar w3-card w3-theme">
        <h1 class="w3-bar-item">API TEST</h1>
    </header>




    <!--
    <div class="w3-container">
        <hr>
        <div class="w3-cell-row">
            <div class="w3-cell" style="width:30%">
                <img class="w3-circle" src="playstore-icon.png" style="width:100%">
            </div>
            <div class="w3-cell w3-container">
                <h3>Daniel</h3>
                <p>The response to the animations was ridiculous.</p>
            </div>
        </div>
        <hr>
        <div class="w3-cell-row">
            <div class="w3-cell" style="width:20%">
                <img class="w3-circle" src="playstore-icon.png" style="width:100%">
            </div>

            <div class="w3-cell" style="width:20%">
                <img class="w3-circle" src="playstore-icon.png" style="width:100%">
            </div>


            <div class="w3-cell w3-container">
                <h3>The Fault in Our Stars</h3>
                <p>Touching, gripping and genuinely well made.</p>
            </div>
        </div>
        <hr>
        <div class="w3-cell-row">
            <div class="w3-cell" style="width:30%">
                <img class="w3-circle" src="playstore-icon.png" style="width:100%">
            </div>
            <div class="w3-cell w3-container">
                <h3>The Avengers</h3>
                <p>A huge success for Marvel and Disney.</p>
            </div>
        </div>
        <hr>
    </div>
-->
    <button id="test">Call API</button>

    <footer class="w3-container w3-theme w3-margin-top">
        <h3>Footer</h3>
    </footer>

    <script>
        function myFunction() {
            alert("Hello! I am an alert box!");
        }

        //jsonp可以解決ajax無法跨域的問題，但只能用get 無法用post
        $(document).ready(function() {
            $("#test").click(function() {

                alert("Click");

                var person = {
                    userName: "player-21",
                    password: "123456"
                }

                $.ajax({
                        type: "get",
                        url: "https://service.health200.tw/insurtech/api/myfitcoin/me",
                        contentType: "application/x-www-form-urlencoded",
                        dataType: "jsonp",
                        jsonp: "myJsonp",
                        jsonpCallback: "myJsonMethod"
                    }).done(function(res) {
                        console.log("done");
                        console.log(res);
                        //alert(res);
                    })
                    .fail(function(res) {
                        console.log("fail");
                        console.log(res);
                    
                        alert(res.statusText);
                        alert(res.status);
                        //alert(res);
                    });


                function myJsonMethod(response) {
                    alert("get");
                    console.log(response);
                }

                //                $.ajax({
                //                    url: "https://service.health200.tw/insurtech/api/myfitcoin/me",
                //                    crossDomain: true,
                //                    success: function(data) {
                //                        console.log(data);
                //                    }
                //                });

                //
                //                // construct an HTTP request
                //                var xhr = new XMLHttpRequest();
                //                xhr.open("post", "https://service.health200.tw/insurtech/api/admin/login", true);
                //                xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
                //
                //                // send the collected data as JSON
                //                xhr.send(JSON.stringify(person));
                //
                //                xhr.onloadend = function() {
                //                     alert("done");
                //                    // done
                //                };


                //ok
                //                $.ajax({
                //                    type: 'POST',
                //                    url: "https://httpbin.org/post",
                //                    data: {
                //                        test2: "1"
                //                    },
                //                    success: function(result) {
                //                        alert("POST success" + JSON.stringify(result));
                //                    },
                //                    error: function(xhr, textStatus, thrownError) {
                //                        alert(textStatus);
                //                    }
                //                });


                //alert(JSON.stringify(person));

                
                $.ajax({
                    url: 'https://service.health200.tw/insurtech/api/admin/login',
                    type: 'POST',
                    dataType: 'json',
                    //contentType: 'application/json',
                    crossDomain: true,
                    success: function(data) {
                        alert("success");
                        //alert(data.msg);
                        //$('#target').html(data.msg);
                    },
                    error: function(xhr, ajaxOptions, thrownError) {
                        alert("error");
                        //alert("thrownError = " + thrownError);
                        //alert("ajaxOptions = " + ajaxOptions);
                        //通常ajaxOptions或thrownError只有一個有值
                    },
                    complete: function(XMLHttpRequest, textStatus) {
                        //alert("textStatus = " + textStatus);

                        //alert("complete");
                        // the options for this ajax request

                    },

                    data: JSON.stringify(person)
                });



                //OK
                //                
                //                $.ajax({
                //                    type: "GET",
                //                    url:"https://httpbin.org/get",
                //                    //url: "https://jsonplaceholder.typicode.com/todos/1",
                //                    //                    data: {
                //                    //                        datafromtestFile: $("#input").val(),
                //                    //                    },
                //                    dataType: "text",
                //                    success: function(happy) {
                //                        alert("Get Success = " + happy);
                //                    },
                //                    error: function(xhr, ajaxOptions, thrownError) {
                //                        alert("error");
                //                        alert("thrownError = " + thrownError);
                //                        alert("ajaxOptions = " + ajaxOptions);
                //                        //通常ajaxOptions或thrownError只有一個有值
                //                    },
                //                    complete: function(XMLHttpRequest, textStatus) {
                //                        alert("textStatus = " + textStatus);
                //                        //alert("complete");
                //                        // the options for this ajax request
                //
                //                    }
                //
                //                })



                //                $.ajax({
                //                    type: "GET",
                //                    url:"https://service.health200.tw/insurtech/api/myfitcoin/me",
                //                    dataType: "text",
                //                    success: function(result) {
                //                        alert("result = " + result);
                //                    },
                //                    error: function(xhr, ajaxOptions, thrownError) {
                //                        alert("error");
                //                    },
                //                    complete: function(XMLHttpRequest, textStatus) {
                //                        alert("textStatus = " + textStatus);
                //                       
                //
                //                    }
                //
                //                })




                //https://tonghuashuo.github.io/blog/jsonp.html
                //ok jsonp 但是到上線時有問題
                //                $.ajax({
                //                        type: "get",
                //                        url: "http://api.forismatic.com/api/1.0/",
                //                        data: {
                //                            method: "getQuote",
                //                            format: "jsonp",
                //                            lang: "en"
                //                        },
                //                        dataType: "jsonp",
                //                        jsonp: "jsonp",
                //                        jsonpCallback: "myJsonMethod"
                //                    }).done(function(res) {
                //                        alert("get");
                //                        console.log("success");
                //                        console.log(res);
                //                    })
                //                    .fail(function(res) {
                //                        console.log("error");
                //                        console.log(res);
                //                    });
                //
                //
                //                function myJsonMethod(response) {
                //                    alert("get");
                //                    console.log(response);
                //                }

                //                                $.ajax({
                //                                    url: "https://service.health200.tw/insurtech/api/myfitcoin/me",
                //                                    crossDomain: true,
                //                                    success: function(data) {
                //                                        console.log(data);
                //                                    }

                //
                //                $.ajax({
                //                    url: "https://service.health200.tw/insurtech/api/myfitcoin/me/?callback=?",
                //                    dataType: "jsonp",
                //                    success: function(data) {
                //                        console.log(data);
                //                    }
                //                });



                /*

                $.ajax({
                    type: "get",
                    url: "https://service.health200.tw/insurtech/api/myfitcoin/me",
                    dataType: "jsonp",
                    jsonp: "jsonp",
                    jsonpCallback: "myJsonMethod2"
                });


                function myJsonMethod2(response) {
                   
                    console.log(response);
                }*/


                /*
                $.ajax({
                    type: "GET",
                    async: false,
                    url: "https://service.health200.tw/insurtech/api/myfitcoin/me",
                    dataType: "jsonp", //指定以jsonp方式執行
                    jsonp: "mycallback", //"mycallback"會以GET的變數名稱傳送，沒指定時，jQuery使用"callback"當變數名稱
                    jsonpCallback: 'aaaa', //"mycallback"變數的值，沒指定時，jQuery隨機產生
                    success: function(res) {
                        console.dir(res)
                    },
                    error: function() {
                        alert('fail');
                    }
                });*/





            });
        });

    </script>

</body>
